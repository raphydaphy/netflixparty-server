<!doctype html>
<html>
<head>
  <title>NetflixParty Server Test</title>
  <script src="./socket.io/socket.io.js"></script>
</head>
<body>
	<h1>NetflixParty Server Test</h1>
	<script>
		var socket = io("http://localhost:3000?userid=1&token=3791c5ec9bbd4fe6");

		socket.on("error", data => {
			console.warn("Authentication error: " + data);
		});

		socket.on("init", data => {
			console.log(`Connected as ${data.userName} with icon ${data.userIcon} and id #${data.userId}!`);

			socket.emit("createSession", {
				videoService: "netflix",
				videoId: 3,
				controlLock: true
			}, response => {
				if (response.error) return console.warn("Failed to create session: ", response.error);
				console.log(response);
			});
		});

		socket.on("disconnect", reason => {
			if (reason == "io server disconnect") {
				console.debug("Socket was disconnected by the server");
			}
		});

		window.addEventListener("beforeunload", (event) => {
	    socket.emit("userDisconnected");
	  });
	</script>
</body>
</html>